<html>

<head>
	<style>
		.container {
			margin-top: 50px;
			margin: auto;
			width: 400;
			height: 600;
		}

		.content {
			width: 400;
			height: 600;
			border: none;
		}
		
		.inputs{
			width: 400px;
			margin: 20px auto;
			display: flex;
		}
		
		input{
			flex-grow: 1;
		}

		body {
			background-color: gray;
		}
	</style>

	<script>
		window.addEventListener("message", receiveMessage, false);

		function receiveMessage(event) {
			document.querySelector('.content').remove();
			setTimeout(() => { alert(event.data); }, 1000);
		}

		function sendMessage() {
			if (iframe) {
				const message = document.getElementById("message").value;
				iframe.contentWindow.postMessage({sender: "TEST", message}, '*');
			}
		}

		let iframe
		function makeAvatar() {
			iframe = document.getElementById('iframe') || document.createElement('iframe')
			iframe.id = "iframe"
			iframe.src = 'http://localhost:3000'
			iframe.className = 'content'
			iframe.allow = "camera *; microphone *"
			document.querySelector('.container').appendChild(iframe)
		}
	</script>
</head>

<body>
	<div class="inputs">
		<input type="button" value="Start" onClick="makeAvatar()" />
		<input type="button" value="Send Message" onClick="sendMessage()" />
		<input id="message" type="text" placeholder="Enter the message to send..." />
	</div>
	<div class="container"></div>
</body>

</html>